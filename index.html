<html>

  <head>
    <meta charset="UTF-8">
    <title>Patrick Bichiou - Deep Learning EA2</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis"></script>
  </head>

  <body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand" href="#">Patrick Bichiou - Deep Learning</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="#">EA 2</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <div class="container">
      <div class="row">
        <h1>EA 2 - Deep Learning: Regression mit FFNN</h1>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col card">
          <div class="card-body">
            <h2>Original data</h2>
            <div id="original-data"></div>
          </div>
        </div>
        <div class="col card">
          <div class="card-body">
            <h2>Noisy data</h2>
            <div id="noisy-data"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="container card mt-2">
      <div class="card-body">
        <div class="row">
          <div class="col">
            <h2>Unnoised model train data</h2>
            <div id="unnoised-model-train"></div>
          </div>
          <div class="col">
            <h2>Unnoised model test data</h2>
            <div id="unnoised-model-test"></div>
          </div>
        </div>
        <div class="row">
          <h3>Unnoised model history</h3>
          <div id="unnoised-model-hist"></div>
        </div>
      </div>
    </div>
    <div class="container card mt-2">
      <div class="card-body">
        <div class="row">
          <div class="col">
            <h2>Best-fit model train data</h2>
            <div id="best-fit-model-train"></div>
          </div>
          <div class="col">
            <h2>Best-fit model test data</h2>
            <div id="best-fit-model-test"></div>
          </div>
        </div>
        <div class="row">
          <h3>Best-fit model history</h3>
          <div id="best-fit-model-hist"></div>
        </div>
      </div>
    </div>
    <div class="container card mt-2">
      <div class="card-body">
        <div class="row">
          <div class="col">
            <h2>Overfit model train data</h2>
            <div id="overfit-model-train"></div>
          </div>
          <div class="col">
            <h2>Overfit model test data</h2>
            <div id="overfit-model-test"></div>
          </div>
        </div>
        <div class="row">
          <h3>Overfit model history</h3>
          <div id="overfit-model-hist"></div>
        </div>
      </div>
    </div>
    <div class="container mt-2">
      <div class="row card">
        <div class="card-body">
          <h2>Dokumentation</h2>
          <p>In diesem Webprojekt ist es dem/der Nutzer:in möglich ein neuronales Netz zu trainieren. <br>
            Das Ziel ist das vorhersagen von Funktionswerten der reellen Funktion y(x) = 0.5*(x+0.8)*(x+1.8)*(x-0.2)*(x-0.3)*(x-1.9)+1, im Intervall [-2, +2].<br>
            <b>Anzahl der Trainingsdaten</b>
            <p>Es werden 100 zufällig generierte Funktionswerte der oben genannten Funktion zum Trainieren des
              neuronalen Netzes generiert</p>
            <b>Model Eigenschaften</b>
            <p>DIe erzeugten Daten werden in 50% Trainigsdaten und 50% Testdaten aufgeteilt. Hierrauf werden die verschiedenen Modelle trainiert. Dabei kommen 2 hidden-Layer zum Einsatz mit jeweils 100 Nueronen. 
              Die Aktivierungsfunktion der hidden-Layer ist eine ReLu, wobei der output-Layer mit einem Neuron linear ist. Als Lernrate wird 0.01 genutzt mit einem Adam-Optimizer und einer Bacht-Size von 32.
              Die Daten wurden außerdem verrauscht, um auch eine Best-Fit-, sowie Overfit-Variante zu bauen. Für das Verrauschen wurde eine Normalverteilung (Gaussian Noise) mit einer Varianz von 0.05 verwendet.
            </p>
            <p>Sobald die Webseite geladen ist, wird das Neuronale Netz trainiert. Anschließend lassen sich im generierten Diagramm die Trainingsdaten mit den vorgergesagten Daten des Netzes vergleichen.
            </p>
          <h3>Frameworks und Libraries</h3>
          <p>
            <a href="https://www.tensorflow.org/js">tf.js</a>: Verwendet für die Modelerzeugung, sowie das Training der Modelle und der Ausgabe dessen<br>
            <a href="https://js.tensorflow.org/api_vis/1.5.1/">tf-vis.js</a>: Verwendet für die Visualisierungen des Trainings bzw. der Daten<br>
            <a href="https://getbootstrap.com/">bootstrap</a>: Library für das Layout bzw. Design der Seite<br>
          </p>
        </div>
      </div>
    </div>
    <div class="container mt-2">
      <div class="row card">
        <div class="card-body">
          <h2>Diskussion</h2>
          <p>
            Ich habe festgestellt, dass mit Tensorflow-js mit relativ wenig Code im Browser Daten generiert, Modelle aufgestellt und trainiert werden können. Hierbei sind die Ergebnisse durchaus brauchbar.
            Als jemand, der dies zuvor noch nie verwendet hat, war der Einstieg nicht ganz so trivial, was weniger am Framework, als an den dahinterliegenden Methoden und Vorgehensweisen, sowie Begriffen liegt,
            auch wenn die Lerneinheiten hier bereits einiges vermitteln.
          </p>
          <p>
            Bei der Erzeugung meines best-fit Modells bin ich so vorgegangen, dass ich relativ viel an den Parametern experimentiert habe, bis ich durchgängi zu guten Ergebnissen gekommen bin. Mit guten Ergebnissen
            ist hierbei gemeint, dass die Vorhersage möglichst nah an den Eingabedfaten liegt.
            Hierzu wurden die folgenden Paramter letztendlich gewählt:
            <ul>
              <li>Die ReLU Aktivierungsfunktion hat sich, als am geeignesten erweisen. Getestet wurden auch ELU, Sigmoid und Softmax.</li>
              <li>Die Auswahl des Optimizers hatte nur wenig Auswirkung, wobei sich der Optimizer Adam, als am besten herausgestellt hat, für das vorliegende Problem.</li>
              <li>Zudem war die Auswahl von vier Layern, mit jeweils 100 Neuronen in den ersten beiden Layern und 50 in Layer 3 und 4</li>
              <li>Als gute Anzahl der epochs hat sich 1500 herausgestellt.</li>
            </ul>
            Die Parameter wurden so gewählt, dass es nicht zu overfitting kommt.
          </p>
          <p>
            Mit Overfitting ist gemeint, dass ein Modell die Trainingsdaten quasi auswendig lernt und diese somit annähernd perfekt nachbildet. Dies ist bei mir insbesondere dann passiert, wenn ich den Wert für
            die epochs sehr hoch eingestellt habe (normalerweise hier 50, beim Overfitting auf 400), da sich das Modell durch die hohe Anzahl an durchgängigen die Daten auswendig lernt.
          </p>
        </div>
      </div>
    </div>

    <script src="./js/script.js"></script>
  </body>
</html>
